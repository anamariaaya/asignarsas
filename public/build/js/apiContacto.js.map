{"version":3,"sources":["apiContacto.js"],"names":["contacto","id","nombres","apellidos","ciudad","correo","celular","mensaje","estado","fecha","btnEnviar","document","querySelector","formulario","fieldset","padTo2Digits","num","toString","padStart","Date","mes","getMonth","dia","getDate","year","getFullYear","hora","getHours","minutos","getMinutes","segundos","getSeconds","fechaFormateada","er","eventListeners","nombresInput","addEventListener","validarFormulario","apellidosInput","ciudadInput","correoInput","celularInput","mensajeInput","iniciarForm","disabled","classList","add","e","target","value","length","error","remove","mostrarError","type","test","console","log","llenarMensaje","mensajeError","createElement","textContent","querySelectorAll","insertBefore","onclick","preventDefault","apiContacto","async","datos","FormData","append","url","respuesta","fetch","method","body","json","resultado","Swal","fire","title","text","icon","then","window","location","reload"],"mappings":"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","file":"apiContacto.js","sourcesContent":["//Variables\r\nconst contacto = {\r\n    id : null,\r\n    nombres : '',\r\n    apellidos : '',\r\n    ciudad: '',\r\n    correo: '',\r\n    celular: '',\r\n    mensaje: '',\r\n    estado: '0',\r\n    fecha: ''\r\n}\r\n\r\nconst btnEnviar = document.querySelector('#enviar');\r\n\r\nconst formulario = document.querySelector('#enviar-mensaje');\r\nconst fieldset = document.querySelector('#fieldset');\r\n\r\n// //Variables para campos\r\nconst nombres = document.querySelector('#nombresInput');\r\nconst apellidos = document.querySelector('#apellidosInput');\r\nconst ciudad = document.querySelector('#ciudadInput');\r\nconst correo = document.querySelector('#correoInput');\r\nconst celular = document.querySelector('#celularInput');\r\nconst mensaje = document.querySelector('#mensajeInput');\r\n\r\n\r\n// //Formatear la fecha\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n  }\r\n\r\nconst fecha = new Date();\r\nconst mes = padTo2Digits(fecha.getMonth() + 1);\r\nconst dia = padTo2Digits(fecha.getDate());\r\nconst year = fecha.getFullYear();\r\nconst hora = padTo2Digits(fecha.getHours());\r\nconst minutos = padTo2Digits(fecha.getMinutes());\r\nconst segundos = padTo2Digits(fecha.getSeconds());\r\nconst fechaFormateada = `${year}-${mes}-${dia} ${hora}:${minutos}:${segundos}`;\r\n\r\ncontacto.fecha = fechaFormateada;\r\n\r\n\r\nconst er = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n\r\nconst num = /^[0-9]+$/;\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    iniciarForm();\r\n    eventListeners();    \r\n});\r\n\r\nfunction eventListeners() {\r\n    nombresInput.addEventListener('blur', validarFormulario);    \r\n    apellidosInput.addEventListener('blur', validarFormulario);\r\n    ciudadInput.addEventListener('blur', validarFormulario);\r\n    correoInput.addEventListener('blur', validarFormulario);\r\n    celularInput.addEventListener('blur', validarFormulario);\r\n    mensajeInput.addEventListener('input', validarFormulario);\r\n\r\n}\r\n\r\nfunction iniciarForm() {\r\n    btnEnviar.disabled = true;\r\n    btnEnviar.classList.add('btn-disabled');\r\n}\r\n\r\nfunction validarFormulario(e) {\r\n    if(e.target.value.length > 0){\r\n        //Elimina los errores\r\n        const error = document.querySelector('.alerta__error');\r\n        if(error){\r\n            error.remove();\r\n        }\r\n       \r\n    } else {\r\n        //console.log('No hay nada');\r\n        mostrarError('Todos los campos son obligatorios');\r\n    }\r\n\r\n    if(e.target.type === 'email'){\r\n        if(er.test(e.target.value) === false){\r\n            mostrarError('Email no valido');\r\n        } \r\n    }\r\n\r\n    if(e.target.type === 'tel'){\r\n        if(num.test(e.target.value) === false || e.target.value.length < 9){\r\n            mostrarError('TelÃ©fono no valido');\r\n        } \r\n    }\r\n\r\n    if(er.test(correoInput.value) && nombresInput.value !== '' && apellidosInput.value !== '' && ciudadInput.value !== '' && celularInput.value !== '' && mensajeInput.value !== ''){\r\n        btnEnviar.disabled = false;\r\n        btnEnviar.classList.remove('btn-disabled');\r\n        console.log('se puede enviar');\r\n        llenarMensaje();\r\n    } else{\r\n        console.log('No se puede enviar');\r\n    }\r\n}\r\n\r\nfunction mostrarError(mensaje){\r\n    const mensajeError = document.createElement('p');\r\n    mensajeError.textContent = mensaje;\r\n    mensajeError.classList.add('alerta', 'alerta__error');\r\n\r\n    const errores = document.querySelectorAll('.alerta__error');\r\n    if(errores.length === 0){\r\n        formulario.insertBefore(mensajeError, fieldset);\r\n    }    \r\n}\r\n\r\nfunction llenarMensaje(){\r\n\r\n    contacto.nombres = nombres.value;\r\n    contacto.apellidos = apellidos.value;\r\n    contacto.ciudad = ciudad.value;\r\n    contacto.correo = correo.value;\r\n    contacto.celular = celular.value;\r\n    contacto.mensaje = mensaje.value;\r\n\r\n    btnEnviar.onclick = function(e){\r\n        e.preventDefault();\r\n        apiContacto();\r\n    }\r\n\r\n\r\n    console.log(contacto);\r\n}\r\n\r\n\r\nasync function apiContacto() {\r\n    const {nombres, apellidos, ciudad, correo, celular, mensaje, estado, fecha} = contacto;\r\n\r\n    const datos = new FormData();\r\n    datos.append('nombres', nombres);\r\n    datos.append('apellidos', apellidos);\r\n    datos.append('ciudad', ciudad);\r\n    datos.append('correo', correo);\r\n    datos.append('celular', celular);\r\n    datos.append('mensaje', mensaje);\r\n    datos.append('estado', estado);\r\n    datos.append('fecha', fecha);\r\n\r\n    try {\r\n        const url = 'http://localhost:3000/api/mensaje';\r\n        \r\n        const respuesta = await fetch(url, {\r\n            method: 'POST',\r\n            body: datos\r\n        });\r\n\r\n        const resultado = await respuesta.json();\r\n\r\n        if(resultado.resultado){\r\n            Swal.fire({\r\n                title: 'Mensaje Enviado',\r\n                text: 'Gracias por escribirnos',\r\n                icon: 'success'\r\n            }).then( () => {\r\n                window.location.reload();\r\n            })\r\n        };\r\n\r\n    } catch(error) {\r\n        console.log(error);\r\n        Swal.fire({\r\n            title: 'Error',\r\n            text: 'Mensaje no enviado. Intenta de nuevo',\r\n            icon: 'error'\r\n        }).then( () => {\r\n            window.location.reload();\r\n        });        \r\n    }\r\n}"]}