const ofertas=document.querySelector("#ciudades"),navCiudades=document.createElement("NAV"),gridVacantes=document.querySelector(".grid-vacantes"),idURL=window.location.search.split("=")[1],tituloSpan=document.querySelector("#ciudad-vacante"),linkCiudad=document.querySelector("#link-ciudad"),infoOferta=document.querySelector(".info-oferta"),infoVacante=document.querySelector("#info-vacante"),infoVacante2=document.querySelector("#info-vacante2"),ciudadCargo=document.querySelector("#ciudad-cargo"),divIndex=document.querySelector(".grid-index-v");function initApi(){consultaCiudades(),consultaOfertas()}function currency(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),"$"+t.join(".")}async function consultaCiudades(){try{const e=await fetch("http://localhost:3000/api/ciudades"),t=await e.json();mostrarCiudades(t),tituloCiudad(t)}catch(e){console.log(e)}}function mostrarCiudades(e){ofertas&&e.forEach(e=>{const{id:t,nombre:n}=e,a=document.createElement("i");a.classList.add("fa","fa-solid","fa-briefcase","no-click");const c=document.createElement("P");c.textContent=n,c.classList.add("no-click");const d=document.createElement("DIV");d.classList.add("iconos","ofertas-icon"),d.appendChild(a),d.appendChild(c);const o=document.createElement("A");o.appendChild(d),o.href="/vacantes?id="+t,navCiudades.appendChild(o),ofertas.appendChild(navCiudades)})}function tituloCiudad(e){tituloSpan&&e.forEach(e=>{const{id:t,nombre:n}=e;t===idURL&&(tituloSpan.textContent=n)})}async function consultaOfertas(){try{const e=await fetch("http://localhost:3000/api/vacantes"),t=await e.json();ofertasIndex(t),mostrarOfertas(t),detalleVacante(t)}catch(e){console.log(e)}}function ofertasIndex(e){divIndex&&e.slice(e.length-4,e.length).forEach(e=>{const{id:t,cargo:n,salario:a,imagen:c,ciudad:d}=e,o=document.createElement("DIV");o.classList.add("vacante","vacante-index");const i=document.createElement("IMG");i.src="/images/"+c,i.alt="Vacante en: "+d,i.setAttribute("loading","lazy");const s=document.createElement("P"),r=document.createElement("SPAN");r.textContent=n,s.appendChild(r);const l=document.createElement("P");l.textContent=currency(a);const u=document.createElement("P");u.textContent="Ubicación: "+d;const p=document.createElement("A");p.classList.add("btn-vacante"),p.textContent="Ver oferta",p.href="/vacante?id="+t,o.appendChild(i),o.appendChild(s),o.appendChild(l),o.appendChild(u),o.appendChild(p),divIndex.appendChild(o)})}function mostrarOfertas(e){if(gridVacantes){const t=[...new Set(e.map(e=>e.idCiudad))];if(idURL&&!t.includes(idURL)){const e=document.querySelector(".sin-vacantes"),t=document.createElement("DIV");t.classList.add("sin-ofertas");const n=document.createElement("i");n.classList.add("fa","fa-solid","fa-warning");const a=document.createElement("P");a.textContent="En este momento no hay vacantes en esta ciudad. Revisa más adelante.",t.appendChild(n),t.appendChild(a),e.appendChild(t)}e.forEach(e=>{const{id:t,cargo:n,salario:a,idCiudad:c,imagen:d,ciudad:o}=e;if(idURL===c){tituloSpan.textContent=o;const e=document.createElement("IMG");e.src="/images/"+d,e.setAttribute("alt","Vacante de "+n),e.setAttribute("loading","lazy");const c=document.createElement("P"),i=document.createElement("SPAN");i.textContent=n,c.appendChild(i);const s=document.createElement("P");s.textContent=currency(a);const r=document.createElement("A");r.textContent="Ver oferta",r.href="/vacante?id="+t,r.classList.add("btn-vacante");const l=document.createElement("DIV");l.classList.add("vacante"),l.appendChild(e),l.appendChild(c),l.appendChild(s),l.appendChild(r),gridVacantes.appendChild(l)}})}}function detalleVacante(e){(infoVacante||infoVacante2)&&e.forEach(e=>{const{id:t,cargo:n,salario:a,horario:c,descripcion:d,correo:o,idCiudad:i,imagen:s,vencimiento:r,whatsapp:l,ciudad:u}=e;if(idURL===t){linkCiudad&&(linkCiudad.href="/vacantes?id="+i,linkCiudad.dataset.ciudad=i);document.querySelector("#oferta-actual").textContent="Vacante: "+n,infoOferta.style.backgroundImage=`url(/images/${s})`;const e=document.createElement("IMG");e.src="/images/"+s,e.setAttribute("alt","Vacante de "+n),e.setAttribute("loading","lazy"),infoVacante.appendChild(e);const p=document.createElement("H3"),m=document.createElement("SPAN");m.textContent="Ubicación: "+u,p.appendChild(m);const f=document.createElement("P");f.innerHTML="<span>Salario: </span>"+currency(a);const C=document.createElement("P");C.innerHTML="<span>Descripción: </span>"+d;const h=document.createElement("P");h.innerHTML="<span>Horario: </span>"+c;const E=document.createElement("P");E.innerHTML="<span>Email: </span>"+o;const g=document.createElement("P"),V=document.createElement("A");V.href="https://wa.me/+57"+l,V.setAttribute("target","_blank");const v=document.createElement("SPAN");v.classList.add("whats"),v.textContent="O escríbenos por WhatsApp dando click aquí",V.appendChild(v),g.appendChild(V);const y=document.createElement("P");y.innerHTML="<span>Esta vacante está disponible hasta el: </span>"+r;const L=document.createElement("A");L.textContent="Postularse",L.href="/postularse?id="+t,L.classList.add("btn-postularse"),infoVacante2.appendChild(p),infoVacante2.appendChild(f),infoVacante2.appendChild(C),infoVacante2.appendChild(h),infoVacante2.appendChild(E),infoVacante2.appendChild(g),infoVacante2.appendChild(y),infoVacante2.appendChild(L)}})}document.addEventListener("DOMContentLoaded",()=>{initApi()});
//# sourceMappingURL=apiOfertas.js.map
