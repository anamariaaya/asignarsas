{"version":3,"sources":["api.js"],"names":["initApi","consultaCiudades","consultaOfertas","document","addEventListener","ofertas","querySelector","navCiudades","createElement","gridVacantes","idURL","window","location","search","split","tituloSpan","linkCiudad","infoOferta","infoVacante","infoVacante2","ciudadCargo","currency","number","str","toString","replace","join","async","resultado","fetch","datos","json","mostrarCiudades","tituloCiudad","error","console","log","ciudades","forEach","ciudad","id","nombre","iconoOferta","classList","add","nombreCiudad","textContent","divCiudad","appendChild","enlaceCiudad","href","mostrarOfertas","detalleVacante","idCiudades","Set","map","oferta","idCiudad","includes","sinVacantes","divSinOfertas","iconoAlerta","mensajeAlerta","cargo","salario","imagen","imagenOferta","src","setAttribute","nombreCargo","spanCargo","salarioOferta","linkOferta","divOferta","horario","descripcion","correo","vencimiento","whatsapp","dataset","style","backgroundImage","spanCiudad","innerHTML","descripcionOferta","horarioOferta","emailOferta","whatsappOferta","linkWhatsapp","spanWhatsapp","vencimientoOferta","linkPostularse"],"mappings":"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","file":"api.js","sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\r\n    initApi();\r\n});\r\n\r\nfunction initApi() {    \r\n    consultaCiudades();    \r\n    consultaOfertas();\r\n}\r\n\r\n//Variables\r\nconst ofertas= document.querySelector('#ciudades');\r\nconst navCiudades = document.createElement('NAV');\r\nconst gridVacantes = document.querySelector('.grid-vacantes');\r\nconst idURL = window.location.search.split('=')[1];\r\nconst tituloSpan = document.querySelector('#ciudad-vacante');\r\nconst linkCiudad = document.querySelector('#link-ciudad');\r\nconst infoOferta = document.querySelector('.info-oferta');\r\nconst infoVacante = document.querySelector('#info-vacante');\r\nconst infoVacante2 = document.querySelector('#info-vacante2');\r\nconst ciudadCargo = document.querySelector('#ciudad-cargo');\r\n\r\n//Funciones globales\r\nfunction currency(number) {\r\n    var str = number.toString().split(\".\");\r\n    str[0] = str[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n    return \"$\" + str.join(\".\");\r\n};\r\n\r\n//Api Ofertas\r\nasync function consultaCiudades(){\r\n    try{\r\n        const resultado = await fetch('http://localhost:3000/api/ciudades');\r\n        const datos = await resultado.json();\r\n        mostrarCiudades(datos);\r\n        tituloCiudad(datos);\r\n\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nfunction mostrarCiudades(ciudades){\r\n    if(ofertas){\r\n        ciudades.forEach(ciudad => {\r\n            const {id, nombre} = ciudad;\r\n    \r\n            //DOM Scripting\r\n            //Generar el ícono\r\n            const iconoOferta = document.createElement('i');\r\n            iconoOferta.classList.add('fa', 'fa-solid', 'fa-briefcase', 'no-click');\r\n    \r\n            //Generar el nombre de la ciudad\r\n            const nombreCiudad = document.createElement('P');\r\n            nombreCiudad.textContent = nombre;\r\n            nombreCiudad.classList.add('no-click');\r\n    \r\n            //Generar el div de la ciudad\r\n            const divCiudad = document.createElement('DIV');\r\n            divCiudad.classList.add('iconos', 'ofertas-icon');\r\n    \r\n            //Asignar el icono y el nombre a la ciudad\r\n            divCiudad.appendChild(iconoOferta);\r\n            divCiudad.appendChild(nombreCiudad);\r\n    \r\n            //Generar el enlace a la oferta\r\n            const enlaceCiudad = document.createElement('A');\r\n            enlaceCiudad.appendChild(divCiudad);\r\n            enlaceCiudad.href = `/vacantes?id=${id}`;        \r\n            \r\n            navCiudades.appendChild(enlaceCiudad);\r\n            ofertas.appendChild(navCiudades);\r\n        });\r\n    }    \r\n}\r\n\r\nfunction tituloCiudad(ciudades){\r\n    if(tituloSpan){\r\n        ciudades.forEach(ciudad => {\r\n            const {id, nombre} = ciudad;\r\n            if(id === idURL){\r\n                tituloSpan.textContent = nombre;\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nasync function consultaOfertas(){\r\n    try{\r\n        const resultado = await fetch('http://localhost:3000/api/vacantes');\r\n        const datos = await resultado.json();\r\n        mostrarOfertas(datos);\r\n        detalleVacante(datos);\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\n\r\nfunction mostrarOfertas(ofertas){\r\n    //hacer un arreglo con todas las idciudad de las ofertas sin repetir\r\n    const idCiudades = [...new Set(ofertas.map(oferta => oferta.idCiudad))];\r\n    \r\n    //Verificar si el idURL no es igual a alguna de las idCiudades para mostrar una alerta   \r\n    if(idURL){\r\n        if(!idCiudades.includes(idURL)){\r\n            const sinVacantes = document.querySelector('.sin-vacantes');\r\n\r\n            const divSinOfertas = document.createElement('DIV');\r\n            divSinOfertas.classList.add('sin-ofertas');\r\n            \r\n            const iconoAlerta = document.createElement('i');\r\n            iconoAlerta.classList.add('fa', 'fa-solid', 'fa-warning');\r\n\r\n            const mensajeAlerta = document.createElement('P');\r\n            mensajeAlerta.textContent = 'En este momento no hay vacantes en esta ciudad. Revisa más adelante.';\r\n\r\n            divSinOfertas.appendChild(iconoAlerta);\r\n            divSinOfertas.appendChild(mensajeAlerta);\r\n\r\n            sinVacantes.appendChild(divSinOfertas);\r\n        }\r\n    }\r\n\r\n    //DOM Scripting para mostrar las ofertas\r\n    if(gridVacantes){\r\n        ofertas.forEach(oferta => {\r\n            const{id, cargo, salario, idCiudad, imagen, ciudad} = oferta; \r\n    \r\n            if(idURL === idCiudad){\r\n                tituloSpan.textContent = ciudad;\r\n                //Generar la imagen de la oferta\r\n                const imagenOferta = document.createElement('IMG');\r\n                imagenOferta.src = `/images/${imagen}`;\r\n                imagenOferta.setAttribute('alt', `Vacante de ${cargo}`);\r\n                imagenOferta.setAttribute('loading', 'lazy');\r\n    \r\n                //Generar el nombre del cargo\r\n                const nombreCargo = document.createElement('P');\r\n                const spanCargo = document.createElement('SPAN');\r\n                spanCargo.textContent = cargo;\r\n    \r\n                //Añadir el Span al P\r\n                nombreCargo.appendChild(spanCargo);\r\n    \r\n                //Generar el salario\r\n                const salarioOferta = document.createElement('P');\r\n                salarioOferta.textContent = currency(salario);\r\n    \r\n                //Link para ver la oferta\r\n                const linkOferta = document.createElement('A');\r\n                linkOferta.textContent = 'Ver oferta';\r\n                linkOferta.href = `/vacante?id=${id}`;\r\n                linkOferta.classList.add('btn-vacante');\r\n    \r\n                //Generar el div de la oferta\r\n                const divOferta = document.createElement('DIV');\r\n                divOferta.classList.add('vacante');\r\n    \r\n                //Añadir la imagen, el nombre del cargo, el salario y el link a la oferta\r\n                divOferta.appendChild(imagenOferta);\r\n                divOferta.appendChild(nombreCargo);\r\n                divOferta.appendChild(salarioOferta);\r\n                divOferta.appendChild(linkOferta);\r\n    \r\n                //Añadir la oferta al grid\r\n                gridVacantes.appendChild(divOferta);            \r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction detalleVacante(ofertas){\r\n    ofertas.forEach(oferta => {\r\n        const {id, cargo, salario, horario, descripcion, correo, idCiudad, imagen, vencimiento, whatsapp, ciudad} = oferta;\r\n\r\n        if(idURL === id){\r\n            if(linkCiudad){\r\n                linkCiudad.href = `/vacantes?id=${idCiudad}`;\r\n                linkCiudad.dataset.ciudad= idCiudad;\r\n          } \r\n\r\n            //generar el título principal\r\n            const tituloPrincipal = document.querySelector('#oferta-actual');\r\n            tituloPrincipal.textContent = `Vacante: ${cargo}`;\r\n\r\n            //Generar la imagen de fondo del div de la oferta\r\n            infoOferta.style.backgroundImage = `url(/images/${imagen})`;\r\n\r\n            //**Elementos del div de la izquierda\r\n\r\n            //Generar la imagen de la oferta\r\n            const imagenOferta = document.createElement('IMG');\r\n            imagenOferta.src = `/images/${imagen}`;\r\n            imagenOferta.setAttribute('alt', `Vacante de ${cargo}`);\r\n            imagenOferta.setAttribute('loading', 'lazy');      \r\n\r\n            infoVacante.appendChild(imagenOferta);\r\n\r\n            //**Elementos del Div de la derecha\r\n            \r\n            //Generar un titulo para la ciudad\r\n            const tituloCiudad = document.createElement('H3');\r\n            const spanCiudad = document.createElement('SPAN');\r\n            spanCiudad.textContent= `Ubicación: ${ciudad}`;\r\n            tituloCiudad.appendChild(spanCiudad);  \r\n\r\n            //Generar el salario del cargo\r\n            const salarioOferta = document.createElement('P');\r\n            salarioOferta.innerHTML = '<span>Salario: </span>' + currency(salario);\r\n\r\n            //Generar la descripción del cargo\r\n            const descripcionOferta = document.createElement('P');\r\n            descripcionOferta.innerHTML = '<span>Descripción: </span>' + descripcion;\r\n\r\n            //Generar el horario del cargo\r\n            const horarioOferta = document.createElement('P');\r\n            horarioOferta.innerHTML = '<span>Horario: </span>' + horario;\r\n\r\n            //Generar el correo del cargo\r\n            const emailOferta = document.createElement('P');\r\n            emailOferta.innerHTML = '<span>Email: </span>' + correo;\r\n\r\n            //Generar el whatsapp del cargo\r\n            const whatsappOferta = document.createElement('P');\r\n            const linkWhatsapp = document.createElement('A');\r\n            linkWhatsapp.href = `https://wa.me/+57${whatsapp}`;\r\n            linkWhatsapp.setAttribute('target', '_blank');\r\n            const spanWhatsapp = document.createElement('SPAN');\r\n            spanWhatsapp.classList.add('whats');\r\n            spanWhatsapp.textContent = 'O escríbenos por WhatsApp dando click aquí';\r\n            linkWhatsapp.appendChild(spanWhatsapp);\r\n            whatsappOferta.appendChild(linkWhatsapp);\r\n\r\n            //generar el vencimiento de la oferta\r\n            const vencimientoOferta = document.createElement('P');\r\n            vencimientoOferta.innerHTML = '<span>Esta vacante está disponible hasta el: </span>' + vencimiento;\r\n\r\n            //Generar el link para postularse\r\n            const linkPostularse = document.createElement('A');\r\n            linkPostularse.textContent = 'Postularse';\r\n            linkPostularse.href = `/postularse?id=${id}`;\r\n            linkPostularse.classList.add('btn-postularse');\r\n\r\n            //Añadir los elementos al div de la oferta\r\n            infoVacante2.appendChild(tituloCiudad);\r\n            infoVacante2.appendChild(salarioOferta);\r\n            infoVacante2.appendChild(descripcionOferta);\r\n            infoVacante2.appendChild(horarioOferta);\r\n            infoVacante2.appendChild(emailOferta);\r\n            infoVacante2.appendChild(whatsappOferta);\r\n            infoVacante2.appendChild(vencimientoOferta);\r\n            infoVacante2.appendChild(linkPostularse);           \r\n        }\r\n\r\n        \r\n   });    \r\n}\r\n"]}